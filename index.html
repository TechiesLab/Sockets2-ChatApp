<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Socket.io #2</title>
  <link rel="shortcut icon" type="image/png" href="images/ico_full.png"/>
  <link rel="stylesheet" href="stylesheet/prism.css">
  <link rel="stylesheet" href="stylesheet/style.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>
<body>

  <!-- Introduction -->
  <div class="banner" style="display: block !important; background-image: linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)), url('https://c1.wallpaperflare.com/preview/422/903/773/socket-plug-current-electricity.jpg');">
    <div class="container text-center">
      <div class="main">
        <img src="images/logo.png" alt="">
        <div class="class-title text-center">
          <h1>SocketIO<br> Fiche 2</h1>
        </div>
      </div>
      <p>Au courant de cette session, nous allons explorer le pouvoir de la librairie <b>socket.io</b> qui permet √† plusieurs navigateurs üíªüì± de communiquer entre eux. <br> Objectif: cr√©er un <em>chat</em>! üí¨</p>
    </div>
  </div>

  <div class="container" id="challenge">

    <div class="accordion" id="accordionExample">

      <!-- √âtape 1 -->
      <div class="card">
        <div class="card-header" id="heading1">
          <h2 class="mb-0">
            <button class="btn btn-link done task" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
              √âtape 1 - D√©fis √† compl√©ter avant
            </button>
          </h2>
        </div>
        <div id="collapse1" class="collapse show" aria-labelledby="heading1" data-parent="#accordionExample">
          <div class="card-body">
            <p>Avant d'entamer ce d√©fi, assure toi d'avoir d√©j√† fait ceux de la Fiche 1</p>
            <ul>
              <li><a href="https://techieslab.github.io/Sockets1-Intro/" target="_blank">Sockets1 - Intro</a></li>
            </ul>
            <p>Ensuite, assure-toi de te munir d'une grande motivation et soif d'apprendre!</p>
            <p>Aussi, assure-toi que tu sois bien connect√© √† ton compte <a href="https://repl.it">Repl.It</a>.</p>
          </div>
        </div>
      </div>

      <!-- √âtape 2 -->
      <div class="card">
        <div class="card-header" id="heading2">
          <h2 class="mb-0">
            <button class="btn btn-link collapsed task" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
              √âtape 2 - Une belle interface = un beau site web <i class="fab fa-html5"></i>!
            </button>
          </h2>
        </div>
        <div id="collapse2" class="collapse" aria-labelledby="heading2" data-parent="#accordionExample">
          <div class="card-body">
          <p>Pour l'instant, ton chat fonctionne, mais d'une console √† une autre. C'est chouette... mais pas id√©al pour pouvoir <em>chatter</em> avec tes amis.</p>
          <p>Ce qu'il nous faudrait, c'est un beau site web, avec une chouette interface pour √©crire nos messages et voir ceux de nos amis.</p>
          <p>Qui dit site web, dit... <b>HTML, CSS</b> et <b>JavaScript</b>!</p>
          <p>On va donc cr√©er <b>un nouveau projet repl.it</b> qui va remplacer notre ancien projet du c√¥t√© <b>Client</b>. Notre nouveau projet sera fait en HTML, CSS et JS, alors choisis bien les langages:</p>
          <img src="./images/new_repl.png" class="img-shadow">

          <p>Te voil√† avec un projet de site web comme on les conna√Æt bien! Vois-tu les 3 fichiers habituels? <code class="language-js">index.html</code>, <code class="language-js">script.js</code> et <code class="language-js">style.css</code></p>

          <img src="./images/3_files.png" class="img-shadow">


          </div>
        </div>
      </div>  <!-- end of card -->

      <div class="card">
        <div class="card-header" id="heading3">
          <h2 class="mb-0">
            <button class="btn btn-link collapsed task" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
              √âtape 3 - Un formulaire üìù pour √©crire des messages
            </button>
          </h2>
        </div>
        <div id="collapse3" class="collapse" aria-labelledby="heading3" data-parent="#accordionExample">
          <div class="card-body">
                    <p>Dans notre fichier HTML, on va cr√©er la base de l'interface de notre chat. Voici un exemple d'interface:</p>

          <img src="./images/chat_interface.png" class="img-shadow">

          <p>Tu peux commencer par coder la partie o√π tes utilsateurs vont √©crire leur message:</p>

          <img src="./images/form.png" class="img-shadow">

          <p>Comment coder cela? √áa te rappelle peut-√™tre un autre d√©fi qu'on a fait en web d√©veloppement? Eh oui, les formulaires dans le d√©fi <a href="https://techieslab.github.io/madlib_instructions/" target="_blank">Madlibs</a>!</p>

          <p>√Ä toi de coder ton formulaire!</p>

          <div class="alert alert-warning" role="alert">
            <p>
              <i class="fas fa-exclamation-circle"></i>
              N'enl√®ve pas la ligne <code class="language-html">&lt;script src="script.js">&lt;/script></code> dans ton fichier <code>index.html</code>. Tu en auras besoin plus tard.
            </p>
          </div>

          <p>
            <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint3a" role="button" aria-expanded="false" aria-controls="collapseHint3a">Indice</a>
          </p>
          <div class="collapse mb-3" id="collapseHint3a">
            <div class="card card-body">
              <p>Ton code pourrait ressembler √† ceci:</p>
              <pre class=language-html>
                <code class="language-html">
                  &lt;form>
                    &lt;input type="text">
                    &lt;input type="button" value="Envoyer">
                  &lt;/form>
                </code>
              </pre>
            </div>
          </div>

          <p>Lorsque tu appuies sur ton bouton "Envoyer", rien ne se passe? C'est normal! Nous allons avoir besoin du JavaScript pour communiquer avec le serveur.</p>

          <p>Par contre, essaie de faire en sorte que ton formulaire apparaisse toujours au bas de ton √©cran.</p>

          <p>
            <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint3b" role="button" aria-expanded="false" aria-controls="collapseHint3b">Indice</a>
          </p>
          <div class="collapse mb-3" id="collapseHint3b">
            <div class="card card-body">
            <p>Tu pourrais avoir besoin de la propri√©t√© <b>CSS</b> suivante:</p>
            <pre class="language-css">
              <code class="language-css">
                position: fixed;
              </code>
            </pre>
            </div>
          </div>

          <p>
            <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer3b" role="button" aria-expanded="false" aria-controls="collapseAnswer3b">R√©ponse</a>
          </p>
          <div class="collapse mb-3" id="collapseAnswer3b">
            <div class="card card-body">
              <img class="img-shadow" src="./images/form-replit.png"></img>
              <p>Voici de quoi a l'air mon <b>HTML</b>:</p>
                <pre class=language-html>
                <code class="language-html">
                  &lt;form>
                    &lt;input type="text">
                    &lt;input type="button" value="Envoyer">
                  &lt;/form>
                </code>
                </pre>

              <p>Et voici de quoi a l'air mon <b>CSS</b>:</p>
              <pre class="language-css">
              <code class="language-css">
                form {
                  position: fixed;
                  bottom: 0;
                  padding: 10px;
                  background-color:bisque;
                  width: 100%;
                }
              </code>
            </pre>
            <p>Bien s√ªr, tu peux choisir une autre couleur d'arri√®re-plan!</p>
            </div>
          </div>
          </div>
        </div>
      </div>  <!-- end of card -->
      <div class="card">
        <div class="card-header" id="heading4">
          <h2 class="mb-0">
            <button class="btn btn-link collapsed task" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="false" aria-controls="collapse4">
              √âtape 4 - Quelques "faux" messages...
            </button>
          </h2>
        </div>
        <div id="collapse4" class="collapse" aria-labelledby="heading4" data-parent="#accordionExample">
          <div class="card-body">
          <p>On va maintenant coder l'inteface pour les messages. Pour l'instant, ce ne seront pas des "vrais" messages qui nous viennent de notre serveur, car nous n'avons pas √©crit le code JS pour relier les deux projets.</p>

          <img src="./images/chat_interface.png" class="img-shadow">

          <p>On va faire semblant que dans notre site, il y a d√©j√† une conversation et que quelques messages ont √©t√© √©chang√©s. Note dans cet exemple d'interface qu'il y a des messages align√©s √† gauche (en blanc) et d'autres align√©s √† droite (en bleu). √Ä ton avis, pourquoi cette distinction?</p>

          <p>
            <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer4a" role="button" aria-expanded="false" aria-controls="collapseAnswer4a">R√©ponse</a>
          </p>
          <div class="collapse mb-3" id="collapseAnswer4a">
            <div class="card card-body">
              <p>Pour distinguer les messages que l'utilisatrice √©crit (√† droite, en bleu) de ceux qu'elle re√ßoit de ses amis (√† gauche, en blanc).</p>
            </div>
          </div>

          <p>√Ä ton tour, essaie de coder les deux premiers messages des amis (√† gauche)! Je te conseille vivement d'utiliser des <code class="language-html">&lt;div>&lt;/div></code> pour cela.</p>

          <img class="img-shadow" src="./images/friends-messages.png"></img>

          <p>
            <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer4b" role="button" aria-expanded="false" aria-controls="collapseAnswer4b">R√©ponse</a>
          </p>
          <div class="collapse mb-3" id="collapseAnswer4b">
            <div class="card card-body">
              <p>Dans ton HTML, il est vraiment important d'embo√Æter chaque message dans une <code class="language-html">&lt;div>&lt;/div></code> √† soi. Par ailleurs, je donne la m√™me <code class="language-js">class</code> √† chacune de ces <code class="language-js">div</code> pour pouvoir toutes les styliser de la m√™me fa√ßon:</p>
              <pre class=language-html>
                <code class="language-html">
                  &lt;div id="messages">
                    &lt;div class="friend-message">
                      Salut, √ßa va? Regarde le beau chat que j'ai cod√©!
                    &lt;/div>
                    &lt;div class="friend-message">
                      J'esp√®re que tu vas aimer!
                    &lt;/div>
                  &lt;/div>
                </code>
              </pre>

              <p>En cons√©quence, je peux avoir ceci dans mon CSS:</p>
              <pre class="language-css">
              <code class="language-css">
                .friend-message {
                  background-color: #708d81;
                  color: white;
                  padding: 10px;
                  margin: 10px;
                  width: 60%;
                }
              </code>
              </pre>
            </div>
          </div>

          <p>Tu peux maintenant coder un ou deux message de ton utilisatrice. Ce sera plus compliqu√©, car il faut que ces messages soit align√©s... √† droite de ton √©cran!</p>

          <img src="./images/friends-me-mess.png" class="img-shadow">

          <p>
            <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint4a" role="button" aria-expanded="false" aria-controls="collapseHint4a">Indice</a>
          </p>
          <div class="collapse mb-3" id="collapseHint4a">
            <div class="card card-body">
              <p>Tu auras besoin d'une nouvelle classe CSS dans laquelle tu pourrais utiliser la propri√©t√© <code class="language-css">float: right;</code></p>
            </div>
          </div>

          <p>
            <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer4c" role="button" aria-expanded="false" aria-controls="collapseAnswer4c">R√©ponse</a>
          </p>
          <div class="collapse mb-3" id="collapseAnswer4c">
            <div class="card card-body">
              <p>J'ai donn√© une nouvelle <code class="language-js">class="me-message"</code> √† chacune des messages de mon utilisatrice pour pouvoir toutes les styliser autrement que les messages des amis:</p>
              <pre class=language-html>
                <code class="language-html">
                  &lt;div id="messages">
                    &lt;div class="friend-message">
                      Salut, √ßa va? Regarde le beau chat que j'ai cod√©!
                    &lt;/div>
                    &lt;div class="friend-message">
                      J'esp√®re que tu vas aimer!
                    &lt;/div>
                    &lt;div class="me-message">
                      Wow, c'est super!
                    &lt;/div>
                    &lt;div class="me-message">
                      Bravo, dis!
                    &lt;/div>
                  &lt;/div>
                </code>
              </pre>

              <p>En cons√©quence, je peux rajouter ceci dans mon CSS:</p>
              <pre class="language-css">
              <code class="language-css">
                .me-message {
                  background-color: #8d0801;
                  color: white;
                  padding: 10px;
                  margin: 10px;
                  width: 60%;
                  float: right;
                }
              </code>
              </pre>
            </div>
          </div>

          </div>
        </div>
      </div>  <!-- end of card -->

      <div class="card">
        <div class="card-header" id="heading5">
          <h2 class="mb-0">
            <button class="btn btn-link collapsed task" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="false" aria-controls="collapse5">
              √âtape 5 -Fais appara√Ætre tes messages dans le chat!
            </button>
          </h2>
        </div>
        <div id="collapse5" class="collapse" aria-labelledby="heading5" data-parent="#accordionExample">
          <div class="card-body">
            <p>Pour l'instant, lorsque tu tapes quelque chose dans le formulaire et que tu appuis sur le bouton "Envoyer", rien ne se passe! Sniff, sniff!üòü</p>

            <p>On va changer cela avec un peu de JavaScript! Dans ton fichier <code>script.js</code>, ajoute un <em>d√©clencheur</em> ou un <em>√©couteur</em>: le navigateur doit "√©couter" voir si l'utilisateur (toi) clique sur le bouton "Envoyer".Te rappelles-tu comment faire pour coder un d√©clencheur/√©couteur?</p>

            <p>Dans le d√©fi <a href="https://techieslab.github.io/madlib_instructions/" target="_blank">Madlibs</a>, tu as d√©j√† cod√© un d√©clencheur pour le bouton "Raconte-moi une histoire". En anglais, on appelle cela un <em>eventListener</em>.</p>

            <p>Tu peux commencer par un d√©clencheur qui va simplement logguer le message dans la console lorsqu'on clique sur le bouton:</p>

            <p>Le code JavaScript de base √† ajouter dans ton fichier <code>script.js</code> est le suivant:</p>

            <pre>
              <code class="language-js">
                function addMyMessage() {
                  // Code √† √©crire
                }

                const submitButton = document.getElementById("submit");
                submitButton.addEventListener(XXX, addMyMessage);
              </code>
            </pre>

            <p>Les trois premi√®res lignes d√©finissent une fonction <code class="language-js">addMyMessage()</code> qu'on va bient√¥t compl√©ter. La ligne suivante signifie qu'on r√©cup√®re (<code class="language-js">get</code>) dans notre fichier HTML la balise qui a l'<b>id</b> "submit". Rajoute l'id "submit" au bon endroit.</p>

            <p>
              <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint5a" role="button" aria-expanded="false" aria-controls="collapseHint5a">Indice</a>
            </p>
            <div class="collapse mb-3" id="collapseHint5a">
              <div class="card card-body">
              <p>Voici la syntaxe: <code class="language-js">id="submit"</code></p>
              </div>
            </div>

            <p>
              <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer5a" role="button" aria-expanded="false" aria-controls="collapseAnswer5a">R√©ponse</a>
            </p>
            <div class="collapse mb-3" id="collapseAnswer5a">
              <div class="card card-body">
                <p>Dans ton fichier <code>index.html</code>, trouve la balise <code class="language-html">&lt;input type="button" value="Envoyer"></code> et ajoutes-y ton <b>id</b>: <code class="language-html">&lt;input type="button" value="Envoyer" id="submit"></code></p>
              </div>
            </div>

            <p>La derni√®re ligne du code JavaScript indique de d√©clencher la fonction <code class="language-js">addMyMessage</code> quand l'utlisateur fait quelque-chose <code class="language-js">XXX</code>. C'est l'√©v√©nement d√©clencheur. Voici plusieurs √©v√©nements possibles:</p>

            <ul>
              <li><code>mouseover</code>: l'utilisatrice passe sa souris par-dessus un √©l√©ment de la page web mais <em>sans cliquer</em></li>
              <li><code>click</code>: l'utilisateur clique sur un √©l√©ment de la page</li>
              <li><code>scroll</code> l'utilisatrice fait d√©filer la page <img src="./images/mouse.jpg"></li>
              <li><code>drag</code> l'utlisateur glisse une section de texte</li>
            </ul>

            <p>Remplace les <code class="language-js">XXX</code> par le bon √©v√©nement.</p>

            <div class="alert alert-warning" role="alert">
              <p>
                <i class="fas fa-exclamation-circle"></i>
                N'oublie pas les guillemets autour de ton √©v√©nement. Par exemple, on √©crira <code class="language-js">"scroll"</code> et non pas <code class="language-js">scroll</code>
              </p>
            </div>

            <p>
              <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer5b" role="button" aria-expanded="false" aria-controls="collapseAnswer5b">R√©ponse</a>
            </p>
            <div class="collapse mb-3" id="collapseAnswer5b">
              <div class="card card-body">
                <p>Il s'agit de l'√©v√©ment <code class="language-js">"click"</code> bien entendu!</p>
                <code class="language-js">submitButton.addEventListener("click", addMyMessage);</code>
              </div>
            </div>

            <p>Maintenant, on peut coder la fonction <code class="language-js">addMyMessage</code>. Tout d'abord cette fonction va simplement afficher un texte dans la console. N'importe quel texte... tu choisis!</p>

            <img src="./images/console_message.gif" class="img-shadow">

            <p>
              <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint5b" role="button" aria-expanded="false" aria-controls="collapseHint5b">Indice</a>
            </p>
            <div class="collapse mb-3" id="collapseHint5b">
              <div class="card card-body">
              <p>Pour afficher quelque-chose dans la console, on utilise <code class="language-js">console.log("beau texte de ton choix")</code>.</p>
              </div>
            </div>

            <p>Ok, tu ma√Ætrises la console! Mais peux-tu faire appara√Ætre dans le console tous les messages que tu √©cris dans ton chat?? Plus dur!!!</p>
            <img src="./images/cons_3mess.gif" class="img-shadow">

            <p>Pour cela, tu devras d'abord r√©cup√©rer (<code class="language-js">getElementById</code>) dans notre fichier HTML la balise de la bo√Æte de texte. Ce n'est pas une mauvaise id√©e de lui donner son propre <b>id</b>, comme ceci, par exemple:</p>

            <pre>
              <code class="language-html">
               &lt;input type="text" id="message">
              </code>
            </pre>

            <p>Et dans <code>script.js</code>, tu peux maintenant r√©cup√©rer l'√©l√©ment <code class="language-js">input</code> qui a l'<b>id</b> <code class="language-js">"message"</code>.</p>

            <p>
              <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint5c" role="button" aria-expanded="false" aria-controls="collapseHint5c">Indice</a>
            </p>
            <div class="collapse mb-3" id="collapseHint5c">
              <div class="card card-body">
                <pre>
                  <code class="language-js">
                    const message = document.getElementById('message');

                    function addMyMessage() {
                      // Code √† √©crire
                      console.log("mais qu'il est beau ce chat")
                    }
                  </code>
                </pre>
              </div>
            </div>

            <p>Maintenant, logue dans ta console le message que tu as √©crit. Indice, tu vas devoir r√©cup√©rer sa <em>valeur</em>...</p>

            <p>
              <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer5c" role="button" aria-expanded="false" aria-controls="collapseAnswer5c">R√©ponse</a>
            </p>
            <div class="collapse mb-3" id="collapseAnswer5c">
              <div class="card card-body">
              <pre>
                <code class="language-js">
                const message = document.getElementById('message');

                function addMyMessage() {
                  // Code √† √©crire
                  console.log(message.value)

                }
                </code>
              </pre>
              </div>
            </div>

            <p>Wow! On a fait du chemin! Derni√®re, derni√®re sous-√©tape: faire appara√Ætre le message dans le chat. Pour cela, le <code class="language-js">console.log()</code> ne suffit plus! Il faut injecter de l'HTML.</p>
            <img src="./images/chat_3mess.gif" class="img-shadow">
            <p>
              <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint5d" role="button" aria-expanded="false" aria-controls="collapseHint5d">Indice</a>
            </p>
            <div class="collapse mb-3" id="collapseHint5d">
              <div class="card card-body">
                <p>Regarde la fonction <a href="https://developer.mozilla.org/fr/docs/Web/API/Element/insertAdjacentHTML" target="_blank"><code class="language-js">.insertAdjacentHTML()</code></a></p>
                <p>La documentation indique que cette fonction s'utilise ainsi: <code class="language-js">element.insertAdjacentHTML(position, text);</code>. √Ä toi de trouver par quoi remplacer:</p>

                <ol>
                  <li><code class="language-js">element</code> (il s'agit d'une balise dans ton HTML)</li>
                  <li><code class="language-js">position</code> (<code class="language-js">'beforebegin'</code>, <code class="language-js">'afterbegin'</code>, <code class="language-js">'beforeend'</code> ou <code class="language-js">'afterend'</code>)</li>
                  <li><code class="language-js">text</code> (le petit morceau d'html que tu vas ins√©rer dans ton fichier html)</li>
                </ol>
              </div>
            </div>

            <p>
              <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint5e" role="button" aria-expanded="false" aria-controls="collapseHint5e">Indice <em>element</em></a>
            </p>
            <div class="collapse mb-3" id="collapseHint5e">
              <div class="card card-body">
                <p>Pour l'√©l√©ment, il faut que tu trouves la balise HTML qui englobe tous tes messages. Je te parie que c'est une <code class="language-js">div</code> et qu'elle a un <code class="language-js">id</code>.</p>
                <p>Je te donne un exemple. Si j'ai ce code <code class="language-js">html</code>:</p>
                <pre>
                  <code class="language-js">
                    &lt;div id="messages">
                      &lt;div class="friend-message">
                        Salut, √ßa va? Regarde le beau chat que j'ai cod√©!
                      &lt;/div>
                      &lt;div class="friend-message">
                        J'esp√®re que tu vas aimer!
                      &lt;/div>
                      &lt;div class="me-message">
                        Wow, c'est super!
                      &lt;/div>
                      &lt;div class="me-message">
                        Bravo, dis!
                      &lt;/div>
                    &lt;/div>
                  </code>
                </pre>

                <p>la balise qui englobe toutes les balises de message, c'est la balise <code class="language-js">div</code> qui a l'<code class="language-js">id</code> <code class="language-js">"messages"</code>. Dans mon javascript, j'√©crirais donc <code class="language-js">let messagesTag = document.getElementById("messages");</code> et du coup, je pourrais utiliser ma variable <code class="language-js">messagesTag</code> comme <code class="language-js">element</code>:</p>
                <pre>
                  <code class="language-js">
                    let messagesTag = document.getElementById("messages");
                    messagesTag.insertAdjacentHTML(position, text);
                  </code>
                </pre>
              </div>
            </div>

            <p>
              <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint5f" role="button" aria-expanded="false" aria-controls="collapseHint5f">Indice <em>text</em></a>
            </p>
            <div class="collapse mb-3" id="collapseHint5f">
              <div class="card card-body">
                <p></p>
              </div>
            </div>




          </div>
        </div>
      </div>  <!-- end of card -->

      <div class="card">
        <div class="card-header" id="heading6">
          <h2 class="mb-0">
            <button class="btn btn-link collapsed task" type="button" data-toggle="collapse" data-target="#collapse6" aria-expanded="false" aria-controls="collapse6">
              √âtape 6 - Connection entre le client HTML et le serveur üëâüëà
            </button>
          </h2>
        </div>
        <div id="collapse6" class="collapse" aria-labelledby="heading6" data-parent="#accordionExample">
          <div class="card-body">
          <p>Lorsque tu √©cris un message dans le chat, il appara√Æt sur ta page web. Maintenant, on aimerait que le <b>serveur</b> puisse aussi recevoir le message et le faire appara√Ætre dans sa console gr√¢ce √† la librairie <code>socket.io</code>. Pour cela, il faut que le client HTML et le serveur soit connect√©s.</p>

          <div class="alert alert-warning" role="alert">
            <p>
              <i class="fas fa-lightbulb"></i> √Ä partir de maintenant, assure-toi que tu aies toujours deux onglets ouverts dans ton navigateur:
              <ol>
                <li>ton projet repl.it pour le <b>client</b></li>
                <li>ton "vieux" projet repl.it pour le <b>serveur</b></li>
              </ol>
            </p>
          </div>

          <h3>Partie client</h3>

          <p>Dans ton projet client, on va d'abord sp√©cifier o√π trouver la librairie <code>socket.io</code> dans notre fichier <code>index.html</code>. √Ä la toute fin de l'√©l√©ment <code>&lt;body></code>, ajoute cet √©l√©ment <code>&lt;script></code>:</p>
          <pre>
            <code class="language-js">
              &lt;body>
                &lt;!-- ton chouette code -->
                &lt;script src="https://cdn.socket.io/4.4.0/socket.io.min.js" integrity="sha384-1fOn6VtTq3PWwfsOrk45LnYcGosJwzMHv+Xh/Jx5303FVOXzEnw0EpLv30mtjmlj" crossorigin="anonymous"></script>
                &lt;script src="script.js"></script>
              &lt;/body>
            </code>
          </pre>

          <p>Ensuite, dans le fichier <code>script.js</code>, ajoute la connection √† la librairie <code>io</code> ainsi:</p>

          <pre>
            <code class="language-js">
            let socket = io("url_de_ton_serveur");
            </code>
          </pre>

          <div class="alert alert-warning" role="alert">
            <p>
              <i class="fas fa-exclamation-circle"></i>
              Tu dois remplacer <code class="language-js">"url_de_ton_serveur"</code> par l'adresse (l'url) de ton projet repl.it pour le <b>serveur</b>. Moi, par exemple c'est ceci:

              <pre>
                <code class="language-js">
                let socket = io("https://chattlserver.margotechieslab.repl.co/");
                </code>
              </pre>

              Voici o√π j'ai trouv√© l'adresse: <img src="./images/url_serveur.png">
            </p>
          </div>

          <p>Derni√®re chose pour le client: on va lui demander d'afficher son num√©ro de connection lorsqu'il se connecte au serveur. √áa sera utile par la suite pour l'identifier, surtout lorsqu'il y aura plusieurs clients qui parleront au serveur!</p>

          <pre>
            <code class="language-js">
            socket.on('connect', function() {
              console.log(socket.id)
            })
            </code>
          </pre>

          <p>Pour l'instant, ce code n'affiche rien dans la console, car la partie serveur n'est pas encore cod√©e. Allons-y!</p>

          <h3>Partie serveur</h3>

          <p>Reprends ton premier projet Repl.it de serveur. Le code qui √©tablit ton serveur doit plus ou moins avoir l'air de ceci:</p>

          <pre>
            <code class="language-js">
              const express = require('express');
              const http = require('http');
              const socket = require('socket.io');

              const app = express();
              const server = http.Server(app);
              const io = socket(server);

              server.listen(3000, function() {
                console.log("Je suis le serveur et j'√©coute vos demandes!");
              });

              io.on('connection', function(connection){
                console.log("il y a un nouveau client");
                connection.on('message', function(data) {
                  io.emit("broadcast", data);
                });
              });
            </code>
          </pre>

          <p>La premi√®re chose √† faire, c'est ajouter au tout tout d√©but de ton code la ligne suivante:</p>

          <pre>
            <code class="language-js">
              const cors = require('cors');
            </code>
          </pre>

          <p>Ensuite, tu dois modifier ta variable <code class="language-js">io</code>. Remplace la ligne <code class="language-js">const io = socket(server);</code> par ce code:</p>

          <pre>
            <code class="language-js">
              const io = socket(server, {
                cors: {
                  origin: "*",
                  methods: ["GET", "POST"]
                }
              });
            </code>
          </pre>

          <p>C'est quoi ces trucs de <code class="language-js">cors</code>? En gros, c'est un m√©canisme de s√©curit√© pour les serveurs. Sur des sites importants, certains ordinateurs clients pourraient envoyer des requ√™tes malicieuses et le but c'est de v√©rifier l'origine des requ√™tes. Comme notre chat n'est pas (encore!) connu dans le monde entier, on peut baisser nos gardes et accepter les requ√™tes de partout :)</p>

          <p>Notre serveur est maintenant pr√™t √† √©couter les clients HTML! Tu peux lancer ton serveur en appuyant sur le bouton RUN. Retourne sur l'onglet de ton client HTML et relance le projet. Dans la console du <b>client</b>, tu devrais voir appara√Ætre l'<code class="language-js">id</code> de ton client. C'est une longue suite de caract√®res avec des lettres et des chiffres:</p>
          <img src="./images/client-id.png" class="img-shadow">

          <p>Du c√¥t√© de ton <b>serveur</b>, tu devrais aussi voir un message dans ta console:</p>
          <img src="./images/client-serveur-console.png" class="img-shadow">

          <p>Yihaaaaa üí™, le serveur et le client sont connect√©s. Derni√®re petite manip: affichons l'identifiant du client (<code class="language-js">id</code>) dans la console du serveur.</p>
          <img src="./images/serveur-connection-id.png" class="img-shadow">

          <div class="alert alert-warning" role="alert">
            <p>
              <i class="fas fa-exclamation-circle"></i>
              Note que l'<code class="language-js">id</code> de ton client va changer si tu relances ton serveur. Ce n'est pas un probl√®me!
              <br>
              <img src="./images/evolving-id.png" class="img-shadow">
            </p>
          </div>

          <p>
            <a class="btn btn-primary" data-toggle="collapse" href="#collapseHint6a" role="button" aria-expanded="false" aria-controls="collapseHint6a">Indice</a>
          </p>
          <div class="collapse mb-3" id="collapseHint6a">
            <div class="card card-body">
              <p>Pour afficher l'<code class="language-js">id</code> de notre client dans la console du serveur, on peut utiliser la variable <code class="language-js">connection</code> et faire ressortir l'<code class="language-js">id</code>comme ceci: <code class="language-js">connection.id</code></p>
            </div>
          </div>

          <p>
            <a class="btn btn-danger" data-toggle="collapse" href="#collapseAnswer6a" role="button" aria-expanded="false" aria-controls="collapseAnswer6a">R√©ponse</a>
          </p>
          <div class="collapse mb-3" id="collapseAnswer6a">
            <div class="card card-body">
              <p>Dans le code de ton serveur, tu peux √©crire quelque chose comme ceci:</p>
              <pre>
                <code class="language-js">
                  io.on('connection', function(connection) {
                    console.log("il y a un nouveau client: " + connection.id);
                    })
                  })
                </code>
              </pre>
            </div>
          </div>


          </div>
        </div>
      </div>  <!-- end of card -->


    </div>
  </div>



<div class="footer">
  <div class="footer-links">
    <a href="https://techieslab.be/"><i class="fas fa-globe"></i></i></a>
    <a href="https://www.facebook.com/TechiesLabBrussels"><i class="fab fa-facebook"></i></a>
    <a href="https://www.linkedin.com/company/techies-lab/"><i class="fab fa-linkedin"></i></a>
    <a href="https://twitter.com/TechiesLab"><i class="fab fa-twitter"></i></a>
  </div>
  <div class="footer-copyright">
    <a href="https://techieslab.be" rel="noopener noreferrer" target="_blank" class="alert-link copyright">
      <i class="far fa-copyright"></i> 2021 Techies Lab ASBL. All rights reserved.
    </a>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="javascript/prism.js"></script>
</body>
</html>
